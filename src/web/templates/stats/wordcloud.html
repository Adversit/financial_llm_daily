{% extends "base.html" %}

{% block breadcrumb %}æ•°æ®ç»Ÿè®¡{% endblock %}

{% block content %}
<style>
    .wordcloud-header {
        background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        border-radius: 12px;
        padding: 2rem;
        color: white;
        margin-bottom: 2rem;
        box-shadow: 0 4px 12px rgba(79, 172, 254, 0.2);
    }

    .wordcloud-title {
        font-size: 1.75rem;
        font-weight: 700;
        margin-bottom: 0.5rem;
    }

    .wordcloud-subtitle {
        font-size: 0.9375rem;
        opacity: 0.95;
    }

    .wordcloud-container {
        background: white;
        border-radius: 12px;
        padding: 2rem;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        margin-bottom: 2rem;
    }

    .wordcloud-controls {
        display: flex;
        gap: 1rem;
        margin-bottom: 2rem;
        flex-wrap: wrap;
    }

    .control-btn {
        padding: 0.625rem 1.5rem;
        border-radius: 8px;
        font-size: 0.875rem;
        font-weight: 500;
        border: 2px solid #e2e8f0;
        background: white;
        cursor: pointer;
        transition: all 0.2s;
    }

    .control-btn:hover {
        border-color: #2563eb;
        color: #2563eb;
    }

    .control-btn.active {
        background: linear-gradient(135deg, #2563eb 0%, #1e4976 100%);
        color: white;
        border-color: transparent;
    }

    .wordcloud-image {
        width: 100%;
        border-radius: 8px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }

    .loading {
        text-align: center;
        padding: 4rem 2rem;
        color: #64748b;
    }
</style>

<div class="wordcloud-header">
    <div class="wordcloud-title">â˜ï¸ è¯äº‘åˆ†æ</div>
    <div class="wordcloud-subtitle">åŸºäºæå–ä¿¡æ¯ç”Ÿæˆçš„å…³é”®è¯è¯äº‘å›¾</div>
</div>

<div class="wordcloud-container">
    <div class="wordcloud-controls">
        <button class="control-btn active" onclick="loadWordcloud('day')">
            ä»Šæ—¥
        </button>
        <button class="control-btn" onclick="loadWordcloud('week')">
            æœ¬å‘¨
        </button>
        <button class="control-btn" onclick="loadWordcloud('month')">
            æœ¬æœˆ
        </button>
    </div>

    <div id="wordcloud-display">
        <div class="loading">
            <div style="font-size: 3rem; margin-bottom: 1rem;">â³</div>
            <div>æ­£åœ¨ç”Ÿæˆè¯äº‘...</div>
        </div>
    </div>
</div>

<div style="background: #eff6ff; border-left: 4px solid #2563eb; padding: 1rem 1.25rem; border-radius: 8px;">
    <div style="font-weight: 600; color: #1e40af; margin-bottom: 0.5rem; display: flex; align-items: center; gap: 0.5rem;">
        <span>ğŸ’¡</span>
        <span>ä½¿ç”¨è¯´æ˜</span>
    </div>
    <ul style="margin: 0; padding-left: 1.25rem; color: #1e40af; font-size: 0.875rem;">
        <li>è¯äº‘å±•ç¤ºæŒ‡å®šæ—¶é—´æ®µå†…æå–ä¿¡æ¯çš„å…³é”®è¯åˆ†å¸ƒ</li>
        <li>å­—ä½“è¶Šå¤§è¡¨ç¤ºè¯¥è¯å‡ºç°é¢‘ç‡è¶Šé«˜</li>
        <li>è‡ªåŠ¨è¿‡æ»¤å¸¸è§åœç”¨è¯ï¼Œä¿ç•™æœ‰æ„ä¹‰çš„å…³é”®è¯</li>
        <li>æ•°æ®æ¯å°æ—¶æ›´æ–°ä¸€æ¬¡ï¼Œç»“æœä¼šè¢«ç¼“å­˜</li>
    </ul>
</div>

<script>
function loadWordcloud(scope) {
    // æ›´æ–°æŒ‰é’®çŠ¶æ€
    document.querySelectorAll('.control-btn').forEach(btn => {
        btn.classList.remove('active');
    });
    event.target.classList.add('active');

    // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
    const display = document.getElementById('wordcloud-display');
    display.innerHTML = `
        <div class="loading">
            <div style="font-size: 3rem; margin-bottom: 1rem;">â³</div>
            <div>æ­£åœ¨ç”Ÿæˆè¯äº‘...</div>
        </div>
    `;

    // åŠ è½½è¯äº‘å›¾ç‰‡
    const img = new Image();
    img.onload = function() {
        display.innerHTML = '';
        img.className = 'wordcloud-image';
        display.appendChild(img);
    };
    img.onerror = function() {
        display.innerHTML = `
            <div class="loading">
                <div style="font-size: 3rem; margin-bottom: 1rem;">âŒ</div>
                <div style="color: #ef4444;">ç”Ÿæˆå¤±è´¥ï¼Œå¯èƒ½æ˜¯æ•°æ®ä¸è¶³æˆ–ç³»ç»Ÿé”™è¯¯</div>
            </div>
        `;
    };
    img.src = `/stats/wordcloud/image?scope=${scope}&width=1200&height=600&_t=${Date.now()}`;
}

// é¡µé¢åŠ è½½æ—¶ç”Ÿæˆä»Šæ—¥è¯äº‘
window.addEventListener('DOMContentLoaded', () => {
    loadWordcloud('day');
});
</script>

{% endblock %}
